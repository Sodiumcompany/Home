<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SODIUM â€¢ Admin - Role Applications</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --bg-dark: #050505;
  --purple: #a855f7;
  --blue: #6366f1;
  --glass: rgba(255, 255, 255, 0.05);
  --glass-border: rgba(255,255,255,0.15);
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
  --gold: #fbbf24;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif;}
html{scroll-behavior:smooth;}
body{background: var(--bg-dark); color:#fff; overflow-x:hidden;}

/* Animated Background Blobs */
.blob {position:fixed; border-radius:50%; filter: blur(80px); z-index:-1;}
.blob1{width:500px;height:500px; background:radial-gradient(circle,#a855f780,transparent); top:10%; left:10%; animation:move1 25s infinite alternate;}
.blob2{width:600px;height:600px; background:radial-gradient(circle,#6366f180,transparent); bottom:0; right:5%; animation:move2 30s infinite alternate;}
@keyframes move1{0%{transform:translate(0,0);}100%{transform:translate(50px,60px);}}
@keyframes move2{0%{transform:translate(0,0);}100%{transform:translate(-70px,-40px);}}

/* Header */
header {
  position: fixed;
  top: 0;
  width: 100%;
  z-index: 1000;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 60px;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

.logo {
  display: flex;
  align-items: center;
  gap: 12px;
}

.logo-icon {
  width: 40px;
  height: 40px;
  background: linear-gradient(135deg, var(--purple), var(--blue));
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 20px;
}

.logo-text {
  font-weight: 700;
  color: #fff;
  font-size: 22px;
  letter-spacing: 2px;
}

.logo-text span {
  color: var(--purple);
}

.admin-badge {
  background: linear-gradient(135deg, var(--gold), #f59e0b);
  color: #000;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 700;
  margin-left: 10px;
  display: inline-flex;
  align-items: center;
  gap: 5px;
}

.header-actions {
  display: flex;
  align-items: center;
  gap: 15px;
}

.back-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 20px;
  background: rgba(255,255,255,0.1);
  color: #fff;
  border: none;
  border-radius: 10px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  text-decoration: none;
}

.back-btn:hover {
  background: rgba(255,255,255,0.2);
  transform: translateY(-2px);
}

/* Admin Container */
.admin-container {
  padding: 150px 60px 60px;
  max-width: 1400px;
  margin: 0 auto;
}

.admin-header {
  text-align: center;
  margin-bottom: 40px;
}

.admin-header h1 {
  font-size: 36px;
  margin-bottom: 10px;
  background: linear-gradient(135deg, var(--gold), #f59e0b);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.admin-header p {
  color: #ccc;
  font-size: 16px;
  max-width: 600px;
  margin: 0 auto;
}

/* Stats Cards */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 40px;
}

.stat-card {
  background: var(--glass);
  backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border);
  border-radius: 16px;
  padding: 25px;
  text-align: center;
  transition: all 0.3s;
}

.stat-card:hover {
  transform: translateY(-5px);
  border-color: var(--gold);
}

.stat-value {
  font-size: 32px;
  font-weight: 700;
  margin-bottom: 5px;
  color: var(--gold);
}

.stat-label {
  font-size: 14px;
  color: #aaa;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.stat-icon {
  font-size: 28px;
  margin-bottom: 15px;
  color: var(--gold);
}

/* Applications Table */
.applications-table-container {
  background: var(--glass);
  backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
  overflow: hidden;
  margin-bottom: 40px;
}

.table-header {
  padding: 25px 30px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.table-header h3 {
  font-size: 20px;
  color: #fff;
  display: flex;
  align-items: center;
  gap: 10px;
}

.table-filters {
  display: flex;
  gap: 10px;
}

.filter-btn {
  padding: 8px 16px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 8px;
  color: #ccc;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}

.filter-btn:hover, .filter-btn.active {
  background: linear-gradient(135deg, var(--gold), #f59e0b);
  color: #000;
  border-color: transparent;
}

.applications-table {
  width: 100%;
  border-collapse: collapse;
}

.applications-table th {
  text-align: left;
  padding: 20px 30px;
  background: rgba(255,255,255,0.05);
  color: #aaa;
  font-weight: 600;
  font-size: 13px;
  text-transform: uppercase;
  letter-spacing: 1px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

.applications-table td {
  padding: 20px 30px;
  border-bottom: 1px solid rgba(255,255,255,0.05);
  color: #ccc;
}

.applications-table tr:hover {
  background: rgba(255,255,255,0.03);
}

.applicant-info {
  display: flex;
  align-items: center;
  gap: 15px;
}

.applicant-avatar {
  width: 40px;
  height: 40px;
  background: linear-gradient(135deg, var(--purple), var(--blue));
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 14px;
}

.applicant-details h4 {
  font-weight: 600;
  color: #fff;
  margin-bottom: 5px;
}

.applicant-details p {
  font-size: 13px;
  color: #aaa;
}

.role-badge {
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  display: inline-block;
}

.role-editor { background: rgba(139, 92, 246, 0.2); color: #8b5cf6; }
.role-designer { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
.role-researcher { background: rgba(16, 185, 129, 0.2); color: #10b981; }
.role-narrator { background: rgba(99, 102, 241, 0.2); color: #6366f1; }
.role-competitive { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
.role-developer { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
.role-media { background: rgba(139, 92, 246, 0.2); color: #8b5cf6; }
.role-gaming { background: rgba(236, 72, 153, 0.2); color: #ec4899; }

.status-badge {
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  display: inline-block;
}

.status-pending { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
.status-approved { background: rgba(16, 185, 129, 0.2); color: #10b981; }
.status-rejected { background: rgba(239, 68, 68, 0.2); color: #ef4444; }

.actions {
  display: flex;
  gap: 8px;
}

.action-btn {
  width: 36px;
  height: 36px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s;
  border: none;
  font-size: 14px;
}

.action-btn.view {
  background: rgba(59, 130, 246, 0.1);
  color: #60a5fa;
}

.action-btn.view:hover {
  background: rgba(59, 130, 246, 0.2);
}

.action-btn.approve {
  background: rgba(16, 185, 129, 0.1);
  color: #4ade80;
}

.action-btn.approve:hover {
  background: rgba(16, 185, 129, 0.2);
}

.action-btn.reject {
  background: rgba(239, 68, 68, 0.1);
  color: #f87171;
}

.action-btn.reject:hover {
  background: rgba(239, 68, 68, 0.2);
}

/* Application Details Modal */
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.8);
  backdrop-filter: blur(10px);
  z-index: 2000;
  align-items: center;
  justify-content: center;
  padding: 20px;
  overflow-y: auto;
}

.modal-content {
  background: var(--bg-dark);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 20px;
  width: 100%;
  max-width: 800px;
  max-height: 90vh;
  overflow-y: auto;
}

.modal-header {
  padding: 25px 30px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-header h3 {
  font-size: 20px;
  color: #fff;
  display: flex;
  align-items: center;
  gap: 10px;
}

.close-modal {
  background: none;
  border: none;
  color: #aaa;
  font-size: 24px;
  cursor: pointer;
  padding: 5px;
  border-radius: 5px;
  transition: color 0.3s;
}

.close-modal:hover {
  color: #fff;
}

.modal-body {
  padding: 30px;
}

.application-details {
  display: grid;
  gap: 30px;
}

.detail-section {
  background: rgba(255,255,255,0.03);
  border-radius: 12px;
  padding: 20px;
}

.detail-section h4 {
  color: var(--gold);
  font-size: 16px;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  gap: 10px;
  padding-bottom: 10px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

.detail-content {
  color: #ccc;
  font-size: 14px;
  line-height: 1.6;
}

.detail-content p {
  margin-bottom: 15px;
}

.detail-content p:last-child {
  margin-bottom: 0;
}

.detail-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.detail-item {
  background: rgba(255,255,255,0.02);
  padding: 15px;
  border-radius: 8px;
}

.detail-label {
  font-size: 12px;
  color: #aaa;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 5px;
}

.detail-value {
  font-weight: 500;
  color: #fff;
}

/* Admin Actions */
.admin-actions-form {
  margin-top: 30px;
  padding-top: 20px;
  border-top: 1px solid rgba(255,255,255,0.1);
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-size: 14px;
  color: #ccc;
}

.form-select, .form-textarea {
  width: 100%;
  padding: 12px 16px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 8px;
  color: #fff;
  font-size: 14px;
}

.form-textarea {
  min-height: 100px;
  resize: vertical;
}

.action-buttons {
  display: flex;
  gap: 15px;
  margin-top: 20px;
}

.primary-btn {
  flex: 1;
  padding: 12px;
  background: linear-gradient(135deg, var(--gold), #f59e0b);
  color: #000;
  border: none;
  border-radius: 8px;
  font-weight: 700;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s;
}

.primary-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(251, 191, 36, 0.3);
}

.secondary-btn {
  flex: 1;
  padding: 12px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  color: #ccc;
  border-radius: 8px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s;
}

.secondary-btn:hover {
  background: rgba(255,255,255,0.1);
  color: #fff;
}

/* No Applications Message */
.no-applications {
  text-align: center;
  padding: 60px 30px;
  color: #aaa;
}

.no-applications i {
  font-size: 48px;
  margin-bottom: 20px;
  color: var(--purple);
}

/* Responsive */
@media (max-width: 1024px) {
  .admin-container {
    padding: 140px 40px 40px;
  }
}

@media (max-width: 768px) {
  header {
    padding: 15px 25px;
  }
  
  .admin-container {
    padding: 130px 25px 40px;
  }
  
  .applications-table {
    display: block;
    overflow-x: auto;
  }
  
  .table-filters {
    flex-wrap: wrap;
  }
  
  .action-buttons {
    flex-direction: column;
  }
}

@media (max-width: 576px) {
  .admin-header h1 {
    font-size: 28px;
  }
  
  .stats-grid {
    grid-template-columns: 1fr;
  }
  
  .logo-text {
    font-size: 18px;
  }
}
</style>
</head>
<body>
<div class="blob blob1"></div>
<div class="blob blob2"></div>

<header>
  <div class="logo">
    <div class="logo-icon">S</div>
    <div class="logo-text">SOD<span>IUM</span><span class="admin-badge"><i class="fas fa-crown"></i> ADMIN</span></div>
  </div>
  
  <div class="header-actions">
    <a href="master-dashboard.html" class="back-btn">
      <i class="fas fa-arrow-left"></i> Back to Dashboard
    </a>
  </div>
</header>

<div class="admin-container">
  <div class="admin-header">
    <h1><i class="fas fa-user-check"></i> Role Applications</h1>
    <p>Review and manage role applications from SODIUM members</p>
  </div>
  
  <!-- Stats Cards -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon"><i class="fas fa-clock"></i></div>
      <div class="stat-value" id="pendingCount">0</div>
      <div class="stat-label">Pending Review</div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
      <div class="stat-value" id="approvedCount">0</div>
      <div class="stat-label">Approved</div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon"><i class="fas fa-times-circle"></i></div>
      <div class="stat-value" id="rejectedCount">0</div>
      <div class="stat-label">Rejected</div>
    </div>
    
    <div class="stat-card">
      <div class="stat-icon"><i class="fas fa-users"></i></div>
      <div class="stat-value" id="totalCount">0</div>
      <div class="stat-label">Total Applications</div>
    </div>
  </div>
  
  <!-- Applications Table -->
  <div class="applications-table-container">
    <div class="table-header">
      <h3><i class="fas fa-list-alt"></i> Role Applications</h3>
      <div class="table-filters">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="pending">Pending</button>
        <button class="filter-btn" data-filter="approved">Approved</button>
        <button class="filter-btn" data-filter="rejected">Rejected</button>
      </div>
    </div>
    
    <div id="applicationsTableContent">
      <table class="applications-table">
        <thead>
          <tr>
            <th>Applicant</th>
            <th>Role</th>
            <th>Applied On</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="applicationsTableBody">
          <!-- Will be populated by JavaScript -->
        </tbody>
      </table>
      
      <div id="noApplications" class="no-applications" style="display: none;">
        <i class="fas fa-inbox"></i>
        <h3>No Applications Found</h3>
        <p>There are no role applications to review at this time.</p>
      </div>
    </div>
  </div>
</div>

<!-- Application Details Modal -->
<div class="modal" id="applicationModal">
  <div class="modal-content">
    <div class="modal-header">
      <h3><i class="fas fa-file-alt"></i> Application Details</h3>
      <button class="close-modal" id="closeModal">&times;</button>
    </div>
    <div class="modal-body">
      <div class="application-details" id="applicationDetails">
        <!-- Will be populated by JavaScript -->
      </div>
      
      <div class="admin-actions-form" id="adminActionsForm">
        <div class="form-group">
          <label><i class="fas fa-user-check"></i> Decision</label>
          <select id="decisionSelect" class="form-select">
            <option value="">Select decision</option>
            <option value="approve">Approve Application</option>
            <option value="reject">Reject Application</option>
            <option value="pending">Keep Pending</option>
          </select>
        </div>
        
        <div class="form-group">
          <label><i class="fas fa-comment"></i> Admin Notes (Optional)</label>
          <textarea id="adminNotes" class="form-textarea" placeholder="Add notes or feedback for the applicant"></textarea>
        </div>
        
        <div class="action-buttons">
          <button type="button" class="primary-btn" id="submitDecisionBtn">
            <i class="fas fa-paper-plane"></i> Submit Decision
          </button>
          <button type="button" class="secondary-btn" id="closeModalBtn">
            <i class="fas fa-times"></i> Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // Check if user is admin
  const adminUser = localStorage.getItem('sodium_admin_user');
  if (!adminUser) {
    window.location.href = 'login.html';
    return;
  }
  
  // Load applications
  loadApplications();
  
  // Setup event listeners
  setupEventListeners();
  
  function loadApplications() {
    try {
      // Load applications from localStorage
      const applications = JSON.parse(localStorage.getItem('sodium_role_applications') || '[]');
      
      // Update stats
      updateStats(applications);
      
      // Populate table
      populateApplicationsTable(applications);
      
    } catch (error) {
      console.error('Error loading applications:', error);
      showNoApplications();
    }
  }
  
  function updateStats(applications) {
    const pending = applications.filter(app => app.status === 'pending').length;
    const approved = applications.filter(app => app.status === 'approved').length;
    const rejected = applications.filter(app => app.status === 'rejected').length;
    const total = applications.length;
    
    document.getElementById('pendingCount').textContent = pending;
    document.getElementById('approvedCount').textContent = approved;
    document.getElementById('rejectedCount').textContent = rejected;
    document.getElementById('totalCount').textContent = total;
  }
  
  function populateApplicationsTable(applications) {
    const tableBody = document.getElementById('applicationsTableBody');
    const noApplications = document.getElementById('noApplications');
    
    if (applications.length === 0) {
      tableBody.innerHTML = '';
      noApplications.style.display = 'block';
      return;
    }
    
    noApplications.style.display = 'none';
    
    // Sort by submission date (newest first)
    applications.sort((a, b) => new Date(b.submittedAt) - new Date(a.submittedAt));
    
    // Clear table
    tableBody.innerHTML = '';
    
    // Populate rows
    applications.forEach((app, index) => {
      const row = document.createElement('tr');
      const submittedDate = new Date(app.submittedAt).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
      });
      
      // Get initials for avatar
      const initials = app.name.split(' ').map(n => n[0]).join('').toUpperCase();
      
      // Get role class
      const roleClass = getRoleClass(app.role);
      
      // Get status badge
      const statusClass = `status-${app.status || 'pending'}`;
      const statusText = app.status ? app.status.charAt(0).toUpperCase() + app.status.slice(1) : 'Pending';
      
      row.innerHTML = `
        <td>
          <div class="applicant-info">
            <div class="applicant-avatar">${initials}</div>
            <div class="applicant-details">
              <h4>${app.name}</h4>
              <p>@${app.username}</p>
            </div>
          </div>
        </td>
        <td><span class="role-badge ${roleClass}">${app.role}</span></td>
        <td>${submittedDate}</td>
        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
        <td>
          <div class="actions">
            <button class="action-btn view" title="View Application" onclick="viewApplication(${index})">
              <i class="fas fa-eye"></i>
            </button>
            <button class="action-btn approve" title="Approve" onclick="approveApplication(${index})" ${app.status === 'approved' ? 'disabled style="opacity:0.5"' : ''}>
              <i class="fas fa-check"></i>
            </button>
            <button class="action-btn reject" title="Reject" onclick="rejectApplication(${index})" ${app.status === 'rejected' ? 'disabled style="opacity:0.5"' : ''}>
              <i class="fas fa-times"></i>
            </button>
          </div>
        </td>
      `;
      
      tableBody.appendChild(row);
    });
  }
  
  function getRoleClass(role) {
    const roleMap = {
      'Video Editor': 'role-editor',
      'Graphics Designer': 'role-designer',
      'Researcher & Script Writer': 'role-researcher',
      'Narrator': 'role-narrator',
      'Competitive IT': 'role-competitive',
      'Development IT': 'role-developer',
      'Media': 'role-media',
      'Gaming': 'role-gaming'
    };
    
    return roleMap[role] || 'role-editor';
  }
  
  function setupEventListeners() {
    // Filter buttons
    const filterBtns = document.querySelectorAll('.filter-btn');
    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        // Remove active class from all buttons
        filterBtns.forEach(b => b.classList.remove('active'));
        
        // Add active class to clicked button
        btn.classList.add('active');
        
        // Apply filter
        applyFilter(btn.dataset.filter);
      });
    });
    
    // Modal close buttons
    document.getElementById('closeModal').addEventListener('click', () => {
      document.getElementById('applicationModal').style.display = 'none';
    });
    
    document.getElementById('closeModalBtn').addEventListener('click', () => {
      document.getElementById('applicationModal').style.display = 'none';
    });
    
    // Close modal when clicking outside
    document.getElementById('applicationModal').addEventListener('click', (e) => {
      if (e.target === document.getElementById('applicationModal')) {
        document.getElementById('applicationModal').style.display = 'none';
      }
    });
    
    // Submit decision button
    document.getElementById('submitDecisionBtn').addEventListener('click', submitDecision);
  }
  
  function applyFilter(filter) {
    const applications = JSON.parse(localStorage.getItem('sodium_role_applications') || '[]');
    let filteredApps = applications;
    
    if (filter !== 'all') {
      filteredApps = applications.filter(app => app.status === filter);
    }
    
    populateApplicationsTable(filteredApps);
  }
  
  function showNoApplications() {
    document.getElementById('applicationsTableBody').innerHTML = '';
    document.getElementById('noApplications').style.display = 'block';
  }
  
  // Global functions for table buttons
  window.viewApplication = function(index) {
    const applications = JSON.parse(localStorage.getItem('sodium_role_applications') || '[]');
    if (applications[index]) {
      showApplicationDetails(applications[index], index);
    }
  };
  
  window.approveApplication = function(index) {
    if (confirm('Are you sure you want to approve this application?')) {
      updateApplicationStatus(index, 'approved', 'Application approved by admin');
    }
  };
  
  window.rejectApplication = function(index) {
    if (confirm('Are you sure you want to reject this application?')) {
      const reason = prompt('Please provide a reason for rejection (optional):');
      updateApplicationStatus(index, 'rejected', reason || 'Application rejected by admin');
    }
  };
  
  function showApplicationDetails(application, index) {
    const detailsDiv = document.getElementById('applicationDetails');
    const submittedDate = new Date(application.submittedAt).toLocaleDateString('en-US', {
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
    
    // Word count helper
    function countWords(text) {
      return text.split(/\s+/).filter(word => word.length > 0).length;
    }
    
    detailsDiv.innerHTML = `
      <div class="detail-section">
        <h4><i class="fas fa-user"></i> Applicant Information</h4>
        <div class="detail-grid">
          <div class="detail-item">
            <div class="detail-label">Name</div>
            <div class="detail-value">${application.name}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Email</div>
            <div class="detail-value">${application.email}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Username</div>
            <div class="detail-value">@${application.username}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Applied Role</div>
            <div class="detail-value"><span class="role-badge ${getRoleClass(application.role)}">${application.role}</span></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Submitted On</div>
            <div class="detail-value">${submittedDate}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Status</div>
            <div class="detail-value"><span class="status-badge status-${application.status || 'pending'}">${application.status ? application.status.charAt(0).toUpperCase() + application.status.slice(1) : 'Pending'}</span></div>
          </div>
        </div>
      </div>
      
      <div class="detail-section">
        <h4><i class="fas fa-bullseye"></i> Role Motivation</h4>
        <div class="detail-content">
          <p>${application.motivation}</p>
          <div class="detail-item" style="margin-top: 10px;">
            <div class="detail-label">Word Count</div>
            <div class="detail-value">${countWords(application.motivation)} words</div>
          </div>
        </div>
      </div>
      
      <div class="detail-section">
        <h4><i class="fas fa-briefcase"></i> Relevant Experience</h4>
        <div class="detail-content">
          <p>${application.experience}</p>
          <div class="detail-item" style="margin-top: 10px;">
            <div class="detail-label">Word Count</div>
            <div class="detail-value">${countWords(application.experience)} words</div>
          </div>
        </div>
      </div>
      
      <div class="detail-section">
        <h4><i class="fas fa-calendar-check"></i> Additional Information</h4>
        <div class="detail-grid">
          <div class="detail-item">
            <div class="detail-label">Availability</div>
            <div class="detail-value">${application.availability || 'Not specified'}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Portfolio/Examples</div>
            <div class="detail-value">${application.portfolio || 'Not provided'}</div>
          </div>
        </div>
      </div>
      
      ${application.reviewedBy ? `
      <div class="detail-section">
        <h4><i class="fas fa-clipboard-check"></i> Review Information</h4>
        <div class="detail-grid">
          ${application.reviewedBy ? `
          <div class="detail-item">
            <div class="detail-label">Reviewed By</div>
            <div class="detail-value">${application.reviewedBy}</div>
          </div>
          ` : ''}
          ${application.reviewDate ? `
          <div class="detail-item">
            <div class="detail-label">Review Date</div>
            <div class="detail-value">${new Date(application.reviewDate).toLocaleDateString()}</div>
          </div>
          ` : ''}
          ${application.notes ? `
          <div class="detail-item" style="grid-column: 1 / -1;">
            <div class="detail-label">Admin Notes</div>
            <div class="detail-value">${application.notes}</div>
          </div>
          ` : ''}
        </div>
      </div>
      ` : ''}
    `;
    
    // Store current application index
    detailsDiv.dataset.applicationIndex = index;
    
    // Show modal
    document.getElementById('applicationModal').style.display = 'flex';
  }
  
  function submitDecision() {
    const decision = document.getElementById('decisionSelect').value;
    const notes = document.getElementById('adminNotes').value.trim();
    const detailsDiv = document.getElementById('applicationDetails');
    const index = parseInt(detailsDiv.dataset.applicationIndex);
    
    if (!decision) {
      alert('Please select a decision first.');
      return;
    }
    
    if (decision === 'pending') {
      document.getElementById('applicationModal').style.display = 'none';
      return;
    }
    
    const adminData = JSON.parse(localStorage.getItem('sodium_admin_user'));
    const adminName = adminData ? adminData.name : 'Administrator';
    
    updateApplicationStatus(index, decision === 'approve' ? 'approved' : 'rejected', notes, adminName);
    
    // Close modal
    document.getElementById('applicationModal').style.display = 'none';
    
    // Reset form
    document.getElementById('decisionSelect').value = '';
    document.getElementById('adminNotes').value = '';
  }
  
  function updateApplicationStatus(index, status, notes, reviewedBy = 'Administrator') {
    try {
      // Get applications
      let applications = JSON.parse(localStorage.getItem('sodium_role_applications') || '[]');
      
      if (applications[index]) {
        // Update application
        applications[index].status = status;
        applications[index].notes = notes;
        applications[index].reviewedBy = reviewedBy;
        applications[index].reviewDate = new Date().toISOString();
        
        // Save back to localStorage
        localStorage.setItem('sodium_role_applications', JSON.stringify(applications));
        
        // Update user's pending application status
        const userId = applications[index].userId;
        localStorage.removeItem(`sodium_pending_application_${userId}`);
        
        // Show success message
        alert(`Application ${status} successfully!`);
        
        // Reload applications
        loadApplications();
        
        // In a real app, you would:
        // 1. Update the user's role in Firestore
        // 2. Send notification to the user
        // 3. Update user dashboard
      }
    } catch (error) {
      console.error('Error updating application:', error);
      alert('Error updating application. Please try again.');
    }
  }
});
</script>
</body>
</html>
