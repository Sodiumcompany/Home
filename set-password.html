<h2>Set Password</h2>

<input id="password" type="password" placeholder="New Password">
<button id="setPassBtn">Finish Account</button>

<script type="module">
import { auth, db } from './firebase.js';
import { isSignInWithEmailLink, signInWithEmailLink, updatePassword } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { doc,setDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

let email=localStorage.getItem("emailForSignIn");

if(isSignInWithEmailLink(auth,location.href)){
await signInWithEmailLink(auth,email,location.href);
}

setPassBtn.onclick=async()=>{
await updatePassword(auth.currentUser,password.value);

await setDoc(doc(db,"users",auth.currentUser.uid),{
name:localStorage.getItem("newName"),
email:email
});

window.location="role.html";
};
</script>
