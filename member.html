<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SODIUM • Member Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Add Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { 
    getAuth, 
    onAuthStateChanged,
    signOut 
  } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
  import { 
    getFirestore, 
    doc, 
    getDoc 
  } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
  
  const firebaseConfig = {
    apiKey: "AIzaSyAUVsLH-YZdbhnH5U8tuS-31bTrPz6CZ8g",
    authDomain: "sodium-b5392.firebaseapp.com",
    projectId: "sodium-b5392",
    storageBucket: "sodium-b5392.firebasestorage.app",
    messagingSenderId: "21034072519",
    appId: "1:21034072519:web:258c82eb4cfed599c301e2",
    measurementId: "G-E0F44QQMD0"
  };

  // Check if user has admin role
function checkAdminRole(userData) {
  const adminAccessSection = document.getElementById('adminAccessSection');
  const adminRoleBadge = document.getElementById('adminRoleBadge');
  const adminPendingBadge = document.getElementById('adminPendingBadge');
  
  if (userData.adminRole) {
    // Show admin access section
    adminAccessSection.style.display = 'block';
    
    // Update admin role badge
    adminRoleBadge.textContent = userData.adminRole;
    
    // Set role color
    const roleColors = {
      'CEO': '#fbbf24',
      'Operations Head': '#3b82f6',
      'Technical Lead': '#8b5cf6',
      'Strategic Director': '#10b981',
      'Community Guidance Director': '#ec4899',
      'Media Manager': '#f59e0b'
    };
    
    if (roleColors[userData.adminRole]) {
      adminRoleBadge.style.background = `linear-gradient(135deg, ${roleColors[userData.adminRole]}, ${roleColors[userData.adminRole]}99)`;
    }
    
    // Setup admin dashboard link
    document.getElementById('menuAdminDashboard').addEventListener('click', (e) => {
      e.preventDefault();
      window.location.href = 'admin-dashboard-template.html';
    });
    
    // Setup role management link
    document.getElementById('menuRoleManagement').addEventListener('click', (e) => {
      e.preventDefault();
      window.location.href = 'admin.html';
    });
    
    // Update pending applications count
    updatePendingApplicationsBadge();
  }
}

function updatePendingApplicationsBadge() {
  const applications = JSON.parse(localStorage.getItem('sodium_role_applications') || '[]');
  const pendingCount = applications.filter(a => a.status === 'pending').length;
  const badge = document.getElementById('adminPendingBadge');
  
  if (pendingCount > 0) {
    badge.textContent = pendingCount;
    badge.style.display = 'inline-block';
  } else {
    badge.style.display = 'none';
  }
}

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  
  window.firebaseAuth = { app, auth, db, onAuthStateChanged, signOut, doc, getDoc };
</script>
<style>
:root {
  --bg-dark: #050505;
  --purple: #a855f7;
  --blue: #6366f1;
  --glass: rgba(255, 255, 255, 0.05);
  --glass-border: rgba(255,255,255,0.15);
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif;}
html{scroll-behavior:smooth;}
body{background: var(--bg-dark); color:#fff; overflow-x:hidden;}

/* Animated Background Blobs */
.blob {position:fixed; border-radius:50%; filter: blur(80px); z-index:-1;}
.blob1{width:500px;height:500px; background:radial-gradient(circle,#a855f780,transparent); top:10%; left:10%; animation:move1 25s infinite alternate;}
.blob2{width:600px;height:600px; background:radial-gradient(circle,#6366f180,transparent); bottom:0; right:5%; animation:move2 30s infinite alternate;}
@keyframes move1{0%{transform:translate(0,0);}100%{transform:translate(50px,60px);}}
@keyframes move2{0%{transform:translate(0,0);}100%{transform:translate(-70px,-40px);}}

/* Header */
header {
  position: fixed;
  top: 0;
  width: 100%;
  z-index: 1000;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 60px;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

.logo {
  display: flex;
  align-items: center;
  gap: 12px;
}

.logo-icon {
  width: 36px;
  height: 36px;
  background: linear-gradient(135deg, var(--purple), var(--blue));
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 18px;
}

.logo-text {
  font-weight: 700;
  color: #fff;
  font-size: 22px;
  letter-spacing: 2px;
}

.logo-text span {
  color: var(--purple);
}

.user-menu {
  display: flex;
  align-items: center;
  gap: 20px;
}

.menu-toggle {
  background: none;
  border: none;
  color: #fff;
  font-size: 24px;
  cursor: pointer;
  padding: 8px;
  border-radius: 8px;
  transition: all 0.3s;
}

.menu-toggle:hover {
  background: rgba(255,255,255,0.1);
}

.user-avatar {
  width: 40px;
  height: 40px;
  background: linear-gradient(135deg, var(--purple), var(--blue));
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  color: white;
  cursor: pointer;
}

/* Sidebar Menu */
.sidebar {
  position: fixed;
  top: 0;
  right: -400px;
  width: 350px;
  height: 100vh;
  background: var(--bg-dark);
  border-left: 1px solid rgba(255,255,255,0.1);
  backdrop-filter: blur(15px);
  z-index: 2000;
  transition: right 0.3s ease;
  overflow-y: auto;
  box-shadow: -5px 0 30px rgba(0,0,0,0.5);
}

.sidebar.active {
  right: 0;
}

.sidebar-header {
  padding: 30px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.sidebar-header h3 {
  font-size: 20px;
  color: #fff;
  display: flex;
  align-items: center;
  gap: 10px;
}

.close-sidebar {
  background: none;
  border: none;
  color: #aaa;
  font-size: 24px;
  cursor: pointer;
  padding: 5px;
  border-radius: 5px;
  transition: color 0.3s;
}

.close-sidebar:hover {
  color: #fff;
}

.sidebar-content {
  padding: 0;
}

.menu-section {
  padding: 20px 0;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

.menu-section:last-child {
  border-bottom: none;
}

.menu-section h4 {
  padding: 0 30px 15px;
  color: #aaa;
  font-size: 13px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.menu-item {
  display: flex;
  align-items: center;
  gap: 15px;
  padding: 15px 30px;
  color: #fff;
  text-decoration: none;
  transition: all 0.3s;
  cursor: pointer;
}

.menu-item:hover {
  background: rgba(255,255,255,0.05);
  padding-left: 35px;
}

.menu-item i {
  width: 20px;
  color: var(--purple);
}

.menu-item span {
  flex: 1;
}

.menu-item .badge {
  background: linear-gradient(135deg, var(--purple), var(--blue));
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
}

.menu-item.danger {
  color: #f87171;
}

.menu-item.danger i {
  color: #f87171;
}

/* Role Status */
.role-status {
  background: rgba(59, 130, 246, 0.1);
  border: 1px solid rgba(59, 130, 246, 0.2);
  border-radius: 10px;
  padding: 15px;
  margin: 20px 30px;
}

.role-status h5 {
  color: #60a5fa;
  font-size: 14px;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.role-status p {
  color: #ccc;
  font-size: 13px;
  margin-bottom: 10px;
}

.role-status .current-role {
  background: linear-gradient(135deg, var(--purple), var(--blue));
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  display: inline-block;
}

/* Member Dashboard */
.dashboard {
  padding: 150px 60px 60px;
  max-width: 1400px;
  margin: 0 auto;
}

/* Welcome Banner */
.welcome-banner {
  background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(99, 102, 241, 0.1));
  border: 1px solid rgba(168, 85, 247, 0.2);
  border-radius: 24px;
  padding: 40px;
  margin-bottom: 40px;
  position: relative;
  overflow: hidden;
}

.welcome-banner::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(255,255,255,0.02)"/></svg>');
  background-size: cover;
}

.welcome-content {
  position: relative;
  z-index: 1;
}

.welcome-content h1 {
  font-size: 36px;
  margin-bottom: 10px;
  background: linear-gradient(135deg, var(--purple), var(--blue));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.welcome-content p {
  color: #ccc;
  font-size: 16px;
  max-width: 600px;
  margin-bottom: 30px;
}

.user-stats {
  display: flex;
  gap: 30px;
  margin-bottom: 30px;
  flex-wrap: wrap;
}

.stat-card {
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 16px;
  padding: 20px;
  min-width: 180px;
  text-align: center;
  transition: transform 0.3s;
}

.stat-card:hover {
  transform: translateY(-5px);
  border-color: var(--purple);
}

.stat-value {
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 5px;
  color: #fff;
}

.stat-label {
  font-size: 14px;
  color: #aaa;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.stat-card .icon {
  font-size: 24px;
  margin-bottom: 15px;
  color: var(--purple);
}

/* Quick Actions */
.quick-actions {
  display: flex;
  gap: 15px;
  margin-top: 20px;
  flex-wrap: wrap;
}

.action-btn {
  padding: 12px 24px;
  background: linear-gradient(135deg, var(--purple), var(--blue));
  color: #fff;
  border: none;
  border-radius: 12px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  gap: 8px;
}

.action-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 20px rgba(168, 85, 247, 0.3);
}

.action-btn.secondary {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.2);
  color: #ccc;
}

.action-btn.secondary:hover {
  background: rgba(255,255,255,0.05);
  border-color: var(--purple);
  color: #fff;
}

/* Dashboard Grid */
.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 30px;
  margin-top: 40px;
}

.dashboard-card {
  background: var(--glass);
  backdrop-filter: blur(15px);
  border: 1px solid var(--glass-border);
  border-radius: 20px;
  padding: 30px;
  transition: all 0.3s;
  position: relative;
  overflow: hidden;
}

.dashboard-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  height: 100%;
  background: linear-gradient(135deg, var(--purple), var(--blue));
}

.dashboard-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 20px 40px rgba(168, 85, 247, 0.2);
  border-color: rgba(168, 85, 247, 0.3);
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
}

.card-header h3 {
  font-size: 20px;
  color: #fff;
  display: flex;
  align-items: center;
  gap: 10px;
}

.card-header .badge {
  background: linear-gradient(135deg, var(--purple), var(--blue));
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
}

/* Loading State */
.loading-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 70vh;
}

.loading-spinner {
  width: 60px;
  height: 60px;
  border: 4px solid rgba(255,255,255,0.1);
  border-radius: 50%;
  border-top-color: var(--purple);
  animation: spin 1s linear infinite;
  margin-bottom: 20px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Animations */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.dashboard-card {
  animation: fadeInUp 0.6s ease forwards;
}

/* Responsive */
@media (max-width: 1024px) {
  .dashboard {
    padding: 140px 40px 40px;
  }
  
  .dashboard-grid {
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  }
}

@media (max-width: 768px) {
  header {
    padding: 15px 25px;
  }
  
  .dashboard {
    padding: 130px 25px 40px;
  }
  
  .welcome-banner {
    padding: 30px 25px;
  }
  
  .user-stats {
    gap: 15px;
  }
  
  .stat-card {
    min-width: 140px;
    padding: 15px;
  }
  
  .quick-actions {
    flex-direction: column;
  }
  
  .sidebar {
    width: 100%;
    right: -100%;
  }
  
  .sidebar.active {
    right: 0;
  }
}

@media (max-width: 576px) {
  .dashboard-grid {
    grid-template-columns: 1fr;
  }
  
  .user-stats {
    justify-content: center;
  }
  
  .stat-card {
    min-width: 120px;
  }
}

/* Overlay for sidebar */
.sidebar-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(5px);
  z-index: 1999;
  display: none;
}

.sidebar-overlay.active {
  display: block;
}
</style>
</head>
<body>
<div class="blob blob1"></div>
<div class="blob blob2"></div>

<!-- Sidebar Overlay -->
<div class="sidebar-overlay" id="sidebarOverlay"></div>

<!-- Sidebar Menu -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <h3><i class="fas fa-bars"></i> Menu</h3>
    <button class="close-sidebar" id="closeSidebar">&times;</button>
  </div>
  
  <div class="sidebar-content">
    <!-- User Profile Section -->
    <div class="menu-section">
      <div style="padding: 0 30px 20px;">
        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
          <div id="sidebarAvatar" style="width: 50px; height: 50px; background: linear-gradient(135deg, var(--purple), var(--blue)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 18px;">
            U
          </div>
          <div>
            <div id="sidebarUserName" style="font-weight: 600; color: #fff; font-size: 16px;">Loading...</div>
            <div id="sidebarUserEmail" style="color: #aaa; font-size: 13px;">Loading...</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Role Status -->
    <div class="role-status" id="roleStatus">
      <h5><i class="fas fa-user-tag"></i> Current Role</h5>
      <p id="currentRoleDesc">You haven't selected a specific role yet. Apply for a role to get access to specialized features.</p>
      <div id="currentRoleBadge" class="current-role">No Role Assigned</div>
    </div>
    
    <!-- Main Menu -->
    <div class="menu-section">
      <h4>Navigation</h4>
      <a href="#" class="menu-item" id="menuDashboard">
        <i class="fas fa-tachometer-alt"></i>
        <span>Dashboard</span>
      </a>
      <a href="#" class="menu-item" id="menuProfile">
        <i class="fas fa-user-circle"></i>
        <span>My Profile</span>
      </a>
      <a href="#" class="menu-item" id="menuEvents">
        <i class="fas fa-calendar-alt"></i>
        <span>Events</span>
        <span class="badge">3 New</span>
      </a>
      <a href="#" class="menu-item" id="menuProjects">
        <i class="fas fa-project-diagram"></i>
        <span>Projects</span>
      </a>
    </div>
    
    <!-- Role & Department -->
    <div class="menu-section">
      <h4>Role & Department</h4>
      <div class="menu-item" id="menuGetRole">
        <i class="fas fa-user-plus"></i>
        <span>Apply for Role</span>
        <span class="badge">New</span>
      </div>
      <a href="#" class="menu-item" id="menuDepartment">
        <i class="fas fa-building"></i>
        <span>My Department</span>
      </a>
      <a href="#" class="menu-item" id="menuAchievements">
        <i class="fas fa-trophy"></i>
        <span>Achievements</span>
      </a>
    </div>
    
    <!-- Account -->
    <div class="menu-section">
      <h4>Account</h4>
      <a href="#" class="menu-item" id="menuSettings">
        <i class="fas fa-cog"></i>
        <span>Settings</span>
      </a>
      <a href="#" class="menu-item" id="menuHelp">
        <i class="fas fa-question-circle"></i>
        <span>Help & Support</span>
      </a>
      <div class="menu-item danger" id="menuLogout">
        <i class="fas fa-sign-out-alt"></i>
        <span>Logout</span>
      </div>
    </div>
  </div>
</div>

<header>
  <div class="logo">
    <div class="logo-icon">S</div>
    <div class="logo-text">SOD<span>IUM</span></div>
  </div>
  
  <div class="user-menu">
    <button class="menu-toggle" id="menuToggle">
      <i class="fas fa-ellipsis-v"></i>
    </button>
    <div class="user-avatar" id="userAvatar">U</div>
  </div>
</header>

<main class="dashboard">
  <!-- Loading State -->
  <div class="loading-container" id="loadingContainer">
    <div class="loading-spinner"></div>
    <p>Loading your SODIUM dashboard...</p>
  </div>
  
  <!-- Content (hidden initially) -->
  <div id="dashboardContent" style="display: none;">
    <!-- Welcome Banner -->
    <section class="welcome-banner">
      <div class="welcome-content">
        <h1 id="welcomeTitle">Welcome Back!</h1>
        <p id="welcomeMessage">Here's what's happening in your SODIUM community today.</p>
        
        <div class="user-stats">
          <div class="stat-card">
            <div class="icon"><i class="fas fa-calendar-check"></i></div>
            <div class="stat-value" id="eventsCount">3</div>
            <div class="stat-label">Upcoming Events</div>
          </div>
          
          <div class="stat-card">
            <div class="icon"><i class="fas fa-trophy"></i></div>
            <div class="stat-value" id="achievementsCount">5</div>
            <div class="stat-label">Achievements</div>
          </div>
          
          <div class="stat-card">
            <div class="icon"><i class="fas fa-users"></i></div>
            <div class="stat-value" id="connectionsCount">42</div>
            <div class="stat-label">Connections</div>
          </div>
          
          <div class="stat-card">
            <div class="icon"><i class="fas fa-user-tag"></i></div>
            <div class="stat-value" id="roleStatusBadge">Member</div>
            <div class="stat-label">Current Role</div>
          </div>
        </div>
        
        <div class="quick-actions">
          <button class="action-btn" id="joinEventBtn">
            <i class="fas fa-plus"></i> Join Event
          </button>
          <button class="action-btn secondary" id="applyRoleBtn">
            <i class="fas fa-user-plus"></i> Apply for Role
          </button>
          <button class="action-btn secondary" id="exploreBtn">
            <i class="fas fa-compass"></i> Explore Community
          </button>
        </div>
      </div>
    </section>
    
    <!-- Dashboard Grid -->
    <div class="dashboard-grid">
      <!-- Upcoming Events Card -->
      <div class="dashboard-card">
        <div class="card-header">
          <h3><i class="fas fa-calendar-alt"></i> Upcoming Events</h3>
          <a href="#" style="color: var(--blue); text-decoration: none; font-size: 14px;">View All</a>
        </div>
        <div style="color: #ccc; font-size: 14px; margin-bottom: 20px;">Your upcoming activities</div>
        <div style="background: rgba(255,255,255,0.03); padding: 20px; border-radius: 12px;">
          <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1);">
            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, var(--purple), var(--blue)); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
              <i class="fas fa-code"></i>
            </div>
            <div>
              <div style="font-weight: 600; color: #fff;">Web Dev Workshop</div>
              <div style="font-size: 13px; color: #aaa;">May 15 • 2:00 PM</div>
            </div>
          </div>
          <div style="display: flex; align-items: center; gap: 15px;">
            <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #f59e0b, #fbbf24); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
              <i class="fas fa-gamepad"></i>
            </div>
            <div>
              <div style="font-weight: 600; color: #fff;">Gaming Tournament</div>
              <div style="font-size: 13px; color: #aaa;">May 22 • 6:00 PM</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Role Information Card -->
      <div class="dashboard-card">
        <div class="card-header">
          <h3><i class="fas fa-user-tag"></i> Role Information</h3>
          <span class="badge" id="roleTypeBadge">Basic</span>
        </div>
        <div id="roleInfoContent">
          <p style="color: #aaa; margin-bottom: 20px;">You are currently a basic member. Apply for a specialized role to unlock more features and responsibilities.</p>
          <div style="background: rgba(59, 130, 246, 0.1); padding: 15px; border-radius: 12px; margin-bottom: 20px;">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
              <i class="fas fa-info-circle" style="color: #60a5fa;"></i>
              <div style="font-weight: 600; color: #60a5fa;">Benefits of Having a Role:</div>
            </div>
            <ul style="color: #ccc; font-size: 13px; padding-left: 20px;">
              <li>Access to specialized projects</li>
              <li>Priority event registration</li>
              <li>Department-specific resources</li>
              <li>Leadership opportunities</li>
            </ul>
          </div>
          <button class="action-btn secondary" id="learnMoreRolesBtn" style="width: 100%;">
            <i class="fas fa-graduation-cap"></i> Learn About Available Roles
          </button>
        </div>
      </div>
      
      <!-- Recent Activity -->
      <div class="dashboard-card">
        <div class="card-header">
          <h3><i class="fas fa-history"></i> Recent Activity</h3>
        </div>
        <div style="color: #ccc; font-size: 14px; margin-bottom: 20px;">Your latest contributions</div>
        <div style="background: rgba(255,255,255,0.03); padding: 15px; border-radius: 12px;">
          <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.05);">
            <i class="fas fa-check-circle" style="color: var(--success);"></i>
            <div style="flex: 1;">
              <div style="font-size: 13px; color: #fff;">Completed Profile Setup</div>
              <div style="font-size: 12px; color: #aaa;">2 hours ago</div>
            </div>
          </div>
          <div style="display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-users" style="color: var(--blue);"></i>
            <div style="flex: 1;">
              <div style="font-size: 13px; color: #fff;">Joined SODIUM Community</div>
              <div style="font-size: 12px; color: #aaa;">1 day ago</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<script>
document.addEventListener('DOMContentLoaded', async () => {
  // Wait for Firebase to load
  await new Promise(resolve => {
    const checkFirebase = setInterval(() => {
      if (window.firebaseAuth) {
        clearInterval(checkFirebase);
        resolve();
      }
    }, 100);
  });
  
  const { auth, db, onAuthStateChanged, signOut, doc, getDoc } = window.firebaseAuth;
  
  let userData = null;
  
  // Check authentication state
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      try {
        // Get user data from Firestore
        const userDoc = await getDoc(doc(db, 'users', user.uid));
        
        if (userDoc.exists()) {
          userData = userDoc.data();
          userData.uid = user.uid;
          
          // Hide loading, show content
          document.getElementById('loadingContainer').style.display = 'none';
          document.getElementById('dashboardContent').style.display = 'block';
          
          // Update user info
          updateUserInfo(userData);
          
          // Set up event listeners
          setupEventListeners(userData);
        } else {
          console.error('User data not found');
          redirectToLogin();
        }
      } catch (error) {
        console.error('Error loading user data:', error);
        // For demo purposes, create demo user data
        userData = {
          uid: 'demo_user',
          name: 'Demo User',
          email: user.email,
          username: 'demo',
          role: 'member',
          currentRole: null,
          roleStatus: 'none'
        };
        
        document.getElementById('loadingContainer').style.display = 'none';
        document.getElementById('dashboardContent').style.display = 'block';
        updateUserInfo(userData);
        setupEventListeners(userData);
      }
    } else {
      redirectToLogin();
    }
  });
  
  function updateUserInfo(userData) {
    // Update welcome message
    document.getElementById('welcomeTitle').textContent = `Welcome back, ${userData.name}!`;
    
    // Update user avatar
    const initials = userData.name.split(' ').map(n => n[0]).join('').toUpperCase();
    document.getElementById('userAvatar').textContent = initials;
    document.getElementById('sidebarAvatar').textContent = initials;
    document.getElementById('sidebarUserName').textContent = userData.name;
    document.getElementById('sidebarUserEmail').textContent = userData.email;
    
    // Update role information
    updateRoleInfo(userData);
  }
  
  function updateRoleInfo(userData) {
    const currentRole = userData.currentRole || 'No Role Assigned';
    const roleStatus = userData.roleStatus || 'none';
    
    // Update role badges
    document.getElementById('roleStatusBadge').textContent = currentRole;
    document.getElementById('currentRoleBadge').textContent = currentRole;
    
    // Update role status description
    let roleDesc = '';
    let roleType = 'Basic';
    
    if (roleStatus === 'applied') {
      roleDesc = 'Your role application is pending review by administrators.';
      roleType = 'Pending Review';
    } else if (roleStatus === 'approved') {
      roleDesc = `You are assigned as: ${currentRole}. You have access to specialized features.`;
      roleType = currentRole;
    } else if (roleStatus === 'rejected') {
      roleDesc = 'Your role application was not approved. You can apply again with more details.';
      roleType = 'Application Rejected';
    } else {
      roleDesc = 'You haven\'t selected a specific role yet. Apply for a role to get access to specialized features.';
      roleType = 'Basic Member';
    }
    
    document.getElementById('currentRoleDesc').textContent = roleDesc;
    document.getElementById('roleTypeBadge').textContent = roleType;
    
    // Update role info content
    const roleInfoContent = document.getElementById('roleInfoContent');
    if (roleStatus === 'approved') {
      roleInfoContent.innerHTML = `
        <div style="text-align: center; margin-bottom: 20px;">
          <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--purple), var(--blue)); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-size: 24px;">
            <i class="fas fa-user-check"></i>
          </div>
          <h4 style="color: #fff; margin-bottom: 10px;">${currentRole}</h4>
          <p style="color: #aaa; font-size: 14px;">You are an active ${currentRole} in SODIUM</p>
        </div>
        <div style="background: rgba(34, 197, 94, 0.1); padding: 15px; border-radius: 12px;">
          <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
            <i class="fas fa-check-circle" style="color: #4ade80;"></i>
            <div style="font-weight: 600; color: #4ade80;">Role Benefits Activated</div>
          </div>
          <ul style="color: #ccc; font-size: 13px; padding-left: 20px;">
            <li>Access to specialized projects</li>
            <li>Priority event registration</li>
            <li>Department-specific resources</li>
            <li>Leadership opportunities</li>
          </ul>
        </div>
      `;
    }
  }
  
  function setupEventListeners(userData) {
    // Sidebar toggle
    const menuToggle = document.getElementById('menuToggle');
    const sidebar = document.getElementById('sidebar');
    const sidebarOverlay = document.getElementById('sidebarOverlay');
    const closeSidebar = document.getElementById('closeSidebar');
    
    menuToggle.addEventListener('click', () => {
      sidebar.classList.add('active');
      sidebarOverlay.classList.add('active');
    });
    
    closeSidebar.addEventListener('click', () => {
      sidebar.classList.remove('active');
      sidebarOverlay.classList.remove('active');
    });
    
    sidebarOverlay.addEventListener('click', () => {
      sidebar.classList.remove('active');
      sidebarOverlay.classList.remove('active');
    });
    
    // Apply for Role buttons
    const applyRoleBtn = document.getElementById('applyRoleBtn');
    const menuGetRole = document.getElementById('menuGetRole');
    const learnMoreRolesBtn = document.getElementById('learnMoreRolesBtn');
    
    const goToRolePage = () => {
      window.location.href = 'role.html';
    };
    
    applyRoleBtn.addEventListener('click', goToRolePage);
    menuGetRole.addEventListener('click', goToRolePage);
    learnMoreRolesBtn.addEventListener('click', goToRolePage);
    
    // Logout functionality
    const logoutBtn = document.getElementById('menuLogout');
    logoutBtn.addEventListener('click', async () => {
      try {
        await signOut(auth);
        window.location.href = 'login.html';
      } catch (error) {
        console.error('Logout error:', error);
        alert('Error logging out. Please try again.');
      }
    });
    
    // Join Event button
    document.getElementById('joinEventBtn').addEventListener('click', () => {
      alert('Event joining feature coming soon!');
    });
    
    // Explore button
    document.getElementById('exploreBtn').addEventListener('click', () => {
      window.location.href = 'index.html#departments';
    });
    
    // Menu items
    document.getElementById('menuDashboard').addEventListener('click', (e) => {
      e.preventDefault();
      sidebar.classList.remove('active');
      sidebarOverlay.classList.remove('active');
    });
    
    document.getElementById('menuProfile').addEventListener('click', (e) => {
      e.preventDefault();
      alert('Profile page coming soon!');
      sidebar.classList.remove('active');
      sidebarOverlay.classList.remove('active');
    });
    
    document.getElementById('menuEvents').addEventListener('click', (e) => {
      e.preventDefault();
      alert('Events page coming soon!');
      sidebar.classList.remove('active');
      sidebarOverlay.classList.remove('active');
    });
    
    // Check if user has pending role application
    checkRoleApplication(userData);
  }
  
  function checkRoleApplication(userData) {
    // Check localStorage for pending applications
    const pendingApps = JSON.parse(localStorage.getItem('sodium_role_applications') || '[]');
    const userApp = pendingApps.find(app => app.userId === userData.uid);
    
    if (userApp) {
      // Update UI to show pending application
      document.getElementById('currentRoleBadge').textContent = 'Pending Review';
      document.getElementById('currentRoleDesc').textContent = `Your application for ${userApp.role} is under review.`;
      document.getElementById('roleTypeBadge').textContent = 'Pending';
      document.getElementById('roleStatusBadge').textContent = 'Pending';
      
      // Update role info content
      document.getElementById('roleInfoContent').innerHTML = `
        <div style="text-align: center; margin-bottom: 20px;">
          <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #f59e0b, #fbbf24); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-size: 24px;">
            <i class="fas fa-clock"></i>
          </div>
          <h4 style="color: #fff; margin-bottom: 10px;">Application Pending</h4>
          <p style="color: #aaa; font-size: 14px;">You applied for: ${userApp.role}</p>
          <p style="color: #f59e0b; font-size: 13px; margin-top: 10px;">Status: Under Review</p>
        </div>
        <div style="background: rgba(245, 158, 11, 0.1); padding: 15px; border-radius: 12px;">
          <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
            <i class="fas fa-info-circle" style="color: #fbbf24;"></i>
            <div style="font-weight: 600; color: #fbbf24;">Application Status</div>
          </div>
          <p style="color: #ccc; font-size: 13px;">Your application has been submitted and is waiting for admin approval. You'll receive a notification once it's reviewed.</p>
        </div>
      `;
    }
  }
  
  function redirectToLogin() {
    window.location.href = 'login.html';
  }
});
</script>
</body>
</html>
